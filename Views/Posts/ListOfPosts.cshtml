@model WheelDeal.Domain.ViewModels.Posts.ListOfPostsViewModel

@{
    ViewBag.Title = "Список объявлений";
    Layout = "_Layout";
}
<h1 xmlns="http://www.w3.org/1999/html">@ViewData["Title"]</h1>

<section class="section-body">
    <section class="section glow">
        <div class="sorts">
            <select id="sort-options">
                <option value="">Лучшее совпадение</option>
                <option value="price-arend-asc">Цена (по возрастанию)</option> <option value="price-arend-desc">Цена (по убыванию)</option>
                <option value="stars-asc">Количество звезд (по возрастанию)</option>
                <option value="stars-desc">Количество звезд (по убыванию)</option>
            </select>
        </div>
        <div class="container-list-posts">
            <div class="filter">
                <h4>Фильтр</h4>
                <div class="price-filter">
                    <label class="title">Цена аренды на день: </label>
                    <label>Минимальная цена: </label>
                    <input type="range" id="arend-min-price" min="0" max="@Math.Round(Model.Posts.Max(p => p.Price))" value="0">
                    <span id="arend-min-label">0</span><br/>
                    <label>Максимальная цена: </label>
                    <input type="range" id="arend-max-price" min="0" max="@Math.Round(Model.Posts.Max(p => p.Price))" value="@Math.Round(Model.Posts.Max(p => p.Price))">
                    <span id="arend-max-label">@Math.Round(Model.Posts.Max(p => p.Price))</span>
                    <div style="padding: 0 10px; justify-content: space-between; color: #321939">Текущие значения: <span id="arend-price-values">0 - @Math.Round(Model.Posts.Max(p => p.Price))</span></div>
                </div>
                <div>
                    <label for="brand">Марка:</label>
                    <select id="brand">
                        <option value="">Все</option>
                        @{
                            List<string?> brandsList = new List<string?>();

                            brandsList = Model.Posts.GroupBy(x => x.Car.Brand).Select(x => x.First().Car.Brand.ToString()).ToList();
                            
                            foreach (var brand in brandsList)
                            {
                                <option value="@brand">@brand</option>
                            }
                        }
                    </select>
                </div>
                <div>
                    <label for="model">Модель:</label>
                    <input type="text" id="model" placeholder="Введите модель">
                </div>
                <div>
                    <label for="year">Год выпуска:</label>
                    <input type="number" id="year" min="1990" max="2024" placeholder="От">
                    <input type="number" id="year-max" min="1990" max="2024" placeholder="До">
                </div>
                <div>
                    <label for="places">Количество мест:</label>
                    <input type="number" id="places" min="2" max="8">
                </div>
                <div>
                    <label for="engine">Объем двигателя:</label>
                    <input type="number" id="engine" min="1.0" max="6.0" step="0.1" placeholder="Литры">
                </div>
                <div>
                    <label for="mileage">Пробег:</label>
                    <input type="number" id="mileage" min="0" max="300000" placeholder="Км">
                </div>
                <div>
                    <label>Тип кузова:</label>
                    <select id="body">
                        <option value="">Все</option>
                        <option value="sedan">Седан</option>
                        <option value="suv">Внедорожник</option>
                        <option value="hatchback">Хэтчбек</option>
                    </select>
                </div>
                <div>
                    <label>Топливо:</label>
                    <select id="fuel">
                        <option value="">Все</option>
                        <option value="petrol">Бензин</option>
                        <option value="diesel">Дизель</option>
                        <option value="electric">Электро</option>
                    </select>
                </div>
                <div>
                    <label>Трансмиссия:</label>
                    <select id="transmission">
                        <option value="">Все</option>
                        <option value="automatic">Автомат</option>
                        <option value="manual">Механика</option>
                    </select>
                </div>
                <div>
                    <label for="power">Мощность (л.с.):</label>
                    <input type="number" id="power" min="50" max="1000" placeholder="Л.с.">
                </div>
                <div class="filter-button">
                    <button id="apply-filter">Применить фильтр</button>
                </div>
            </div>
            <div class="container-posts">
                <div class="list-posts">
                    @foreach (var item in Model.Posts)
                    {
                        <div class="post-item" data-price="@item.Price" data-stars="@item.Stars">
                            <div class="item-stars">
                                <img src="~/images/star.png" class="star" />
                                <p style="margin-left: 2px">@item.Stars</p>
                            </div>
                            @if (item.ImagesPaths.Count > 0)
                            {
                                <img src="@item.ImagesPaths.FirstOrDefault()" class="item-post-img" />
                            }
                            else
                            {
                                <img src="/images/posts/default.png" class="item-post-img" />
                            }
                            <div class="item-info">
                                <h6>@(item.Car?.Brand ?? "") @(item.Car?.Model ?? "") (@item.Car?.Year)</h6>
                                <p>@item.Description</p>
                                <div class="available-status" style="@(item.AvailabilityStatus ? "background-color: #37f100;" : "background-color: #f10000;")"></div>
                                <button class="post-item-btn">(@item.Price) р/день</button>
                                <p style="margin: 4px 0 0 0; color: #494848; font-size: 12px; text-align: right">@item.CreatedAt.ToShortDateString()</p>
                            </div>
                            <input asp-for="@item.Id" value="@item.Id" style="display: none" />
                            <input asp-for="@item.CategoryId" value="@item.CategoryId" style="display: none" />
                        </div>
                    }
                </div>
            </div>
        </div>
    </section>    
</section>